vq.PaCo=function(){vq.Vis.call(this),this.height(400),this.width(600),this.vertical_padding(0),this.horizontal_padding(0)},vq.PaCo.prototype=pv.extend(vq.Vis),vq.PaCo.prototype._setOptionDefaults=function(a){a.height!=null&&this.height(a.height),a.width!=null&&this.width(a.width),a.vertical_padding!=null&&this.vertical_padding(a.vertical_padding),a.horizontal_padding!=null&&this.horizontal_padding(a.horizontal_padding),a.container!=null&&this.container(a.container)},vq.PaCo.prototype.draw=function(a){this._pa_co_data=new vq.models.PaCoData(a),this._pa_co_data.isDataReady()&&(this._setOptionDefaults(this._pa_co_data),this.render())},vq.PaCo.prototype.getFiltered=function(){var a=this,b=a._pa_co_data,c=b._data;filtered_data=c.filter(function(c){return b._dims.every(function(a){return c[a]!=undefined})&&b._dims.every(function(b){return c[b]<=a.filter[b].max&&c[b]>=a.filter[b].min})});return filtered_data},vq.PaCo.prototype.getSelected=function(){return this._pa_co_data.selected||null},vq.PaCo.prototype.render=function(){function u(b){if(b.dy<3){var d=b.dim;a.filter[d].min=Math.max(i[d].domain()[0],i[d].invert(0)),a.filter[d].max=Math.min(i[d].domain()[1],i[d].invert(c)),b.y=0,b.dy=c,active=d,l.render()}return!1}function t(b){var d=b.dim;a.filter[d].min=Math.max(i[d].domain()[0],i[d].invert(c-b.y-b.dy)),a.filter[d].max=Math.min(i[d].domain()[1],i[d].invert(c-b.y)),active=d,l.render();return!1}function p(a,b){var c={};e.hovered=b,f[0]=this.mouse();var d=n(f[0].x);c.label=b[e._label_column],c.coordinate=d,c.value=b[d];var g={};g[c.label]=function(a){return a.coordinate+" "+a.value},pv.Behavior.flextip({include_header:!1,include_footer:!1,timeout:20,param_data:!0,on_mark:!1,close_timeout:"inf",data_config:g}).call(this.parent,c),e.highlight.render()}function n(a){var b=e._dims[0],c=999999;e._dims.forEach(function(d){var e=Math.abs(h(d)-a);c>e&&(b=d,c=e)});return b}function m(){return e._data.filter(function(b){return e._dims.every(function(c){return b[c]<=a.filter[c].max&&b[c]>=a.filter[c].min})})}var a=this,b=a.width(),c=a.height(),d=a.container(),e=a._pa_co_data,f=[{x:0,y:0,dx:0,dy:0}],g={label:"",coordinate:"",value:0};e.hovered=null;var h=pv.Scale.ordinal(e._dims).splitFlush(0,b),i={},j={};e._dims.forEach(function(a){e._coordinates[e._coordinates_map[a]].scale_type==undefined&&(e._coordinates[e._coordinates_map[a]].scale_type="linear");var b=e._coordinates[e._coordinates_map[a]],d=b.min_value!=undefined?b.min_value:pv.min(e._data,function(b){return b[a]}),f=b.max_value!=undefined?b.max_value:pv.max(e._data,function(b){return b[a]});switch(b.scale_type){case"log":d=d>0?d:.1,i[a]=pv.Scale.log(d,f).range(0,c).nice(),j[a]=pv.Scale.log(d,f).range("steelblue","brown").nice();break;case"linear":case"default":i[a]=pv.Scale.linear(d,f).range(0,c),j[a]=pv.Scale.linear(d,f).range("steelblue","brown")}}),a.filter=pv.dict(e._dims,function(a){return{min:i[a].domain()[0],max:i[a].domain()[1]}}),active=e._dims[0];var k=(new pv.Panel).width(b).height(c).left(a.horizontal_padding()).right(a.horizontal_padding()).top(a.vertical_padding()).bottom(a.vertical_padding()).canvas(d);k.add(pv.Panel).data(e._data).visible(function(b){return e._dims.every(function(c){return b[c]<=a.filter[c].max&&b[c]>=a.filter[c].min})}).add(pv.Line).data(e._dims).left(function(a){return h(a)}).bottom(function(a,b){return i[a](b[a])}).strokeStyle("#ddd").lineWidth(1).antialias(!1),rule=k.add(pv.Rule).data(e._dims).left(h),rule.anchor("top").add(pv.Label).top(-12).font("bold 16px sans-serif").text(function(a){return a});var l=k.add(pv.Panel),o=l.add(pv.Panel).event("click",function(a){e.selected=e.hovered,r.render()}).events("all"),q=o.add(pv.Panel).data(m).add(pv.Line).data(e._dims).events("painted").event("click",function(a){e.selected=e.hovered,r.render()}).event("mouseover",p).left(function(a,b){return h(a)}).bottom(function(a,b){return i[a](b[a])}).strokeStyle(function(a,b){return j[active](b[active])}).lineWidth(1),r=l.add(pv.Panel).data(function(){return[e.hovered,e.selected]}).event("click",function(a){e.selected=e.hovered,r.render()}).visible(function(a){return a!=undefined});r.add(pv.Line).data(e._dims).events("painted").event("mouseover",p).strokeStyle(function(a,b){return this.parent.index==1?"red":"yellow"}).left(function(a,b){return h(a)}).lineWidth(2.5).bottom(function(a,b){return i[a](b[a])}),e.highlight=r;var s=l.add(pv.Panel);s.data(e._dims.map(function(a){return{y:0,dy:c,dim:a}})).left(function(a){return h(a.dim)-15}).width(30).fillStyle("rgba(0,0,0,.1)").strokeStyle("rgba(0,0,0,.5)").lineWidth(".2px").events("all").cursor("crosshair").event("mousedown",pv.Behavior.select()).event("select",t).event("selectend",u).add(pv.Bar).left(10).top(function(a){return a.y}).width(10).height(function(a){return a.dy}).fillStyle(function(b){return b.dim==active?j[b.dim]((a.filter[b.dim].max+a.filter[b.dim].min)/2):"hsla(0,0,50%,.5)"}).strokeStyle("white").cursor("move").event("mousedown",pv.Behavior.drag()).event("dragstart",t).event("drag",t),s.anchor("bottom").add(pv.Label).textBaseline("top").text(function(b){return a.filter[b.dim].min.toPrecision(3)}),s.anchor("top").add(pv.Label).textBaseline("bottom").text(function(b){return a.filter[b.dim].max.toPrecision(3)}),k.render()},vq.models.PaCoData=function(a){vq.models.VisData.call(this,a),this.setDataModel(),this.getDataType()=="vq.models.PaCoData"?this._build_data(this.getContents()):console.warn("Unrecognized JSON object.  Expected vq.models.PaCoData object.")},vq.models.PaCoData.prototype=pv.extend(vq.models.VisData),vq.models.PaCoData.prototype._build_data=function(a){var b=this;this._processData(a),this._coordinates!=null?(this._dims=this._coordinates.map(function(a){return a.id}),this._coordinates_map=pv.numerate(b._coordinates,function(a){return a.id}),this.setDataReady(!0)):console.error("Coordinate configuration not passed to constructor!")},vq.models.PaCoData.prototype.setDataModel=function(){this._dataModel=[{label:"width",id:"PLOT.width",cast:Number,defaultValue:700},{label:"height",id:"PLOT.height",cast:Number,defaultValue:300},{label:"container",id:"PLOT.container",optional:!0},{label:"vertical_padding",id:"PLOT.vertical_padding",cast:Number,defaultValue:20},{label:"horizontal_padding",id:"PLOT.horizontal_padding",cast:Number,defaultValue:30},{label:"_data",id:"data_array",defaultValue:[]},{label:"_identifier_column",id:"CONFIGURATION.identifier_column ",cast:String,defaultValue:""},{label:"_label_column",id:"CONFIGURATION.label_column",cast:String,defaultValue:""},{label:"_coordinates",id:"CONFIGURATION.COORD_COLUMN_ARRAY",defaultValue:[]},{label:"tooltipItems",id:"tooltip_items",defaultValue:{Name:"nodeName",Parent:"parentNode.nodeName"}},{label:"_notifier",id:"notifier",cast:Function,defaultValue:function(){return null}}]}