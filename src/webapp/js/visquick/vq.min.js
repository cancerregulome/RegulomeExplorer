/** @namespace Top-level namespace, vq **/vq={},vq.Base=function(){this.$properties={}},vq.Base.prototype.properties={},vq.Base.cast={},vq.Base.prototype.extend=function(a){return this},vq.Base.prototype.property=function(a,b){this.hasOwnProperty("properties")||(this.properties=pv.extend(this.properties)),this.properties[a]=!0,vq.Base.prototype.propertyMethod(a,vq.Base.cast[a]=b);return this},vq.Base.prototype.propertyValue=function(a,b){var c=this.$properties;c[a]=b;return b},vq.Base.prototype.propertyMethod=function(a,b){b||(b=vq.Base.cast[a]),this[a]=function(c){if(arguments.length){var d=typeof c=="function";this.propertyValue(a,d&1&&b?function(){var a=c.apply(this,arguments);return a!=null?b(a):null}:c!=null&&b?b(c):c).type=d;return this}return this.$properties[a]!=null?typeof this.$properties[a]=="function"&1?this.$properties[a].apply(this):this.$properties[a]:null}},vq.Vis=function(){vq.Base.call(this)},vq.Vis.prototype=pv.extend(vq.Base),vq.Vis.prototype.property("vertical_padding",Number).property("horizontal_padding",Number).property("width",Number).property("height",Number).property("container",function(a){return typeof a=="string"?document.getElementById(a):a}),vq.models={},vq.models.VisData=function(a){a.DATATYPE!=null?this.DATATYPE=a.DATATYPE:this.DATATYPE="VisData",a.CONTENTS!=null&&(this.CONTENTS=a.CONTENTS),this._ready=!1},vq.models.VisData.prototype.getDataType=function(){return this.DATATYPE},vq.models.VisData.prototype.getContents=function(){return this.CONTENTS},vq.models.VisData.prototype.get=function(a){var b=a.split("."),c=this;for(var d=0;d<b.length-1;d++){var e=b[d];c[e]===undefined&&(c[e]={}),c=c[e]}e=b[b.length-1];return c[e]===undefined?undefined:c[e]},vq.models.VisData.prototype.set=function(a,b){var c=a.split("."),d=this;for(var e=0;e<c.length-1;e++){var f=c[e];d[f]===undefined&&(d[f]={}),d=d[f]}f=c[c.length-1],d[f]=b===undefined?null:b;return this},vq.models.VisData.prototype.isDataReady=function(){return this._ready},vq.models.VisData.prototype.setDataReady=function(a){this._ready=Boolean(a)},vq.models.VisData.prototype.setValue=function(a,b){var c=vq.utils.VisUtils.get;if(typeof c(a,b.id)=="function")this.set(b.label,c(a,b.id));else{if(b.cast){this.set(b.label,b.cast(c(a,b.id)));return}this.set(b.label,c(a,b.id));return}},vq.models.VisData.prototype._processData=function(a){var b=this,c=vq.utils.VisUtils.get;this.hasOwnProperty("_dataModel")||(this._dataModel=pv.extend(this._dataModel)),a=Object(a),this._dataModel.forEach(function(d){try{if(!typeof d=="object")return;if(!d.optional)c(a,d.id)===undefined?b.set(d.label,d.defaultValue!=undefined?d.defaultValue:d.cast(null)):b.setValue(a,d);else{if(c(a,d.id)===undefined)return;b.setValue(a,d)}}catch(e){console.warn('Unable to import property "'+d.id+'": '+e)}})},vq.utils={},vq.utils.VisUtils={},vq.utils.VisUtils.createDiv=function(a,b,c){var d;try{d=document.createElement("<div>")}catch(e){}if(!d||!d.name)d=document.createElement("div");a&&(d.id=a),b&&(d.className=b,d.setAttribute("className",b)),c&&(d.innerHTML=c);return d},vq.utils.VisUtils.clone=function(a){if(!a||"object"!=typeof a)return a;var b="[object Array]"===Object.prototype.toString.call(a)?[]:{},c,d;for(c in a)a.hasOwnProperty(c)&&(d=a[c],d&&"object"==typeof d?b[c]=vq.utils.VisUtils.clone(d):b[c]=d);return b},vq.utils.VisUtils.get=function(a,b){var c=b.split(".");for(var d=0;d<c.length-1;d++){var e=c[d];a[e]===undefined&&(a[e]={}),a=a[e]}e=c[c.length-1];return a[e]===undefined?undefined:a[e]},vq.utils.VisUtils.set=function(a,b,c){var d=b.split(".");for(var e=0;e<d.length-1;e++){var f=d[e];a[f]===undefined&&(a[f]={}),a=a[f]}f=d[d.length-1],a[f]=c||null;return this},vq.utils.VisUtils.alphanumeric=function(a,b){return isNaN(a||b)?isNaN(b||a)?[a,b].sort():1:isNaN(b||a)?-1:Number(a)-Number(b)},vq.utils.VisUtils.network_node_id=function(a){var b=vq.utils.VisUtils.options_map(a);if(b!=null&&b.label!=undefined)return b.label;return a.nodeName+a.start.toFixed(2)+a.end.toFixed(2)},vq.utils.VisUtils.network_node_title=function(a){var b=vq.utils.VisUtils.options_map(a);if(b!=null&&b.label!=undefined)return b.label+" \n"+"Chr: "+a.nodeName+"\nStart: "+a.start+"\nEnd: "+a.end;return a.nodeName+" "+a.start.toFixed(2)+" "+a.end.toFixed(2)},vq.utils.VisUtils.tick_node_id=function(a){return a.value},vq.utils.VisUtils.extend=function(a,b){for(var c in b)a[c]=b[c];return a},vq.utils.VisUtils.parse_pairs=function(a,b,c){var d={},e=[],f=[];e=[],f=a.split(c);for(var g=0;g<f.length;g++)e=f[g].split(b),e.length==2&&(d[e[0]]=e[1]);return d},vq.utils.VisUtils.options_map=function(a){var b={};a.options!=null&&(b=vq.utils.VisUtils.parse_pairs(a.options,"=",","));return b},vq.utils.VisUtils.wrapProperty=function(a){return typeof a=="function"?a:function(){return a}},vq.utils.VisUtils.pivotArray=function(a,b,c,d,e,f,g){var h=pv.uniq(a.map(function(a){return a[b]})).sort(),i=pv.nest(a).key(function(a){return a[c]}).map(),j=pv.values(i).map(function(a){var g={};f?(g=vq.utils.VisUtils.clone(a[0]),delete g[d],delete g[b]):g[c]=a[0][c],a.forEach(function(a){g[a[b]]=a[d]});if(e)switch(e.operation){case"collect":g[e.column]=pv.map(a,function(a){return a[e.column]});break;case"mean":g[e.column]=pv.mean(a,function(a){return a[e.column]});break;case"min":g[e.column]=pv.min(a,function(a){return a[e.column]});break;case"max":g[e.column]=pv.max(a,function(a){return a[e.column]});break;case"sum":default:g[e.column]=pv.sum(a,function(a){return a[e.column]})}return g});g&&(j=j.filter(function(a){return h.every(function(b){return a[b]})}));return j},vq.utils.VisUtils.layoutChrTiles=function(a,b,c,d){var e=d||Boolean(!1),f=[],g=[];g=pv.uniq(a,function(a){return a.chr}),g.forEach(function(d){f=pv.blend([f,vq.utils.VisUtils.layoutTiles(a.filter(function(a){return a.chr==d}),b,c,e)])}),a.forEach(function(a){var b=null,c=0,d=pv.keys(a);do b=d.every(function(b){return a[b]==f[c][b]||isNaN(a[b]&&isNaN(f[c][b]))?1:0}),c++;while(c<f.length&&b!=1);a.level=f[c-1].level});return a},vq.utils.VisUtils.layoutChrTicks=function(a,b,c){return vq.utils.VisUtils.layoutChrTiles(a,b,c,!0)},vq.utils.VisUtils.layoutTiles=function(a,b,c,d){var e=d||Boolean(!1);a.forEach(function(a){a.tile_length=a.end-a.start}),a=a.sort(function(a,b){return a.tile_length<b.tile_length?-1:a.tile_length>b.tile_length?1:a.start<b.start?-1:1}).reverse(),a.length&&(a[0].level=0),a.forEach(function(a,d,f){var g=f.slice(0,d).map(function(c){var d=vq.utils.VisUtils.extend({},c),f=vq.utils.VisUtils.extend({},a);c.end==null?d.end=f.start+.1:a.end==null&&(f.end=f.start+.1);return vq.utils.VisUtils._isOverlapping(d,f,b||0,e)?c.level:null});g=g.filter(function(a){return a!=null}).sort(pv.naturalOrder);var h=0,i=0;while(h>=g[i])h==g[i]&&h++,i++;c===undefined?a.level=h:a.level=h<=c?h:Math.floor(Math.random()*(c+1))});return a},vq.utils.VisUtils._isOverlapping=function(a,b,c,d){var e=d||Boolean(!1);return e?a.start-c<=b.start&&a.start+c>=b.start:a.start-c<=b.end&&a.end+c>=b.start},vq.utils.VisUtils.cumulativeOffset=function(a){var b=0,c=0;if(a.parentNode)do b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;while(a);return{left:c,top:b}},vq.utils.VisUtils.viewportOffset=function(a){var b=0,c=0,d=document.body,e=a;do{b+=e.offsetTop||0,c+=e.offsetLeft||0;if(e.offsetParent==d&&e.style.position=="absolute")break}while(e=e.offsetParent);e=a;do e!=d&&(b-=e.scrollTop||0,c-=e.scrollLeft||0);while(e=e.parentNode);return{left:c,top:b}},vq.utils.VisUtils.scrollOffset=function(a){var b=0,c=0;do b+=a.scrollTop||0,c+=a.scrollLeft||0;while(a=a.parentNode);return{left:c,top:b}},vq.utils.VisUtils.outerHTML=function(a){return a.outerHTML||function(a){var b=document.createElement("div"),c;b.appendChild(a.cloneNode(!0)),c=b.innerHTML,b=null;return c}(a)},vq.utils.VisUtils.translateToReferenceCoord=function(a,b){var c=vq.utils.VisUtils.scrollOffset(b.root.canvas());return{x:a.x+c.left,y:a.y+c.top}},vq.utils.VisUtils.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0,c=a=="x"?b:b&3|8;return c.toString(16)})},vq.utils.VisUtils.openBrowserTab=function(a){var b=window.open(a,"_blank");b.focus()},vq.utils.VisUtils.disabler=function(a){a.preventDefault&&a.preventDefault();return!1},vq.utils.VisUtils.disableSelect=function(a){a.attachEvent?a.attachEvent("onselectstart",vq.utils.VisUtils.disabler):a.addEventListener("selectstart",vq.utils.VisUtils.disabler,!1)},vq.utils.VisUtils.enableSelect=function(a){a.attachEvent?a.detachEvent("onselectstart",vq.utils.VisUtils.disabler):a.removeEventListener("selectstart",vq.utils.VisUtils.disabler,!1)},vq.utils.VisUtils.insertGCFCode=function(){document.write(' \n<!--[if lt IE 9]> \n    <script type="text/javascript" \n     src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script> \n    <style> \n     .chromeFrameInstallDefaultStyle { \n       width: 100%;  \n       border: 5px solid blue; \n     } \n    </style> \n            <div id="notice"></div> \n            <div id="prompt"></div> \n    <script> \n          function displayGCFText() { \n            document.getElementById("notice").innerHTML = "Internet Explorer has been detected." + \n            "Please install the Google Chrome Frame if it is not already installed.  This will enable" + \n            "HTML5 features necessary for the web application.<p>"+ \n            "If the install panel does not appear, please enable Compatibility mode in your browser and reload this page."; \n            }; \n     window.attachEvent("onload", function() { \n       CFInstall.check({ \n         mode: "inline",  \n         node: "prompt" \n       }); \n     }); \n    </script> \n  <![endif]-->')},vq.utils.GoogleDSUtils={},vq.utils.GoogleDSUtils.dataTableToArray=function(a){var b=a,c=[],d=[],e=[];if(b==null)return[];for(col=0;col<b.getNumberOfColumns();col++)d.push(b.getColumnLabel(col)),e.push(b.getColumnType(col));for(row=0;row<b.getNumberOfRows();row++){var f={};for(col=0;col<b.getNumberOfColumns();col++)e[col].toLowerCase()=="number"?f[d[col]]=b.getValue(row,col):f[d[col]]=b.getFormattedValue(row,col);c.push(f)}return c},vq.utils.GoogleDSUtils.dataTableToNetworkArray=function(a){var b=this.dataTableToArray(a);return b.map(function(a){return{node1:{chr:a.chr1,start:a.start1,end:a.end1,value:a.value1,options:a.options1},node2:{chr:a.chr2,start:a.start2,end:a.end2,value:a.value2,options:a.options2},linkValue:a.linkValue}})},vq.utils.GoogleDSUtils.getColIndexByLabel=function(a,b){for(col=0;col<a.getNumberOfColumns();col++)if(b.toLowerCase()==a.getColumnLabel(col).toLowerCase())return col;return-1},vq.utils.SyncDatasources=function(a,b,c,d,e){a&&!isNaN(a)?this.timeout=a:this.timeout=200,b&&!isNaN(b)?this.num_checks_until_quit=b:this.num_checks_until_quit=20;if(d instanceof Object)this.args=d;else{console.log("Error: variable array not passed to timer initialize method.");return}if(c instanceof Function)this.success_callback=c;else{console.log("Error: callback function not passed to timer initialize method.");return}e instanceof Function&&(this.fail_callback=e),this.num_checks_so_far=0},vq.utils.SyncDatasources.prototype.start_poll=function(){var a=this;setTimeout(function(){a.poll_args()},a.timeout)},vq.utils.SyncDatasources.prototype.check_args=function(){var a=!0;for(arg in this.args)this.args[arg]==null&&(a=!1);return a},vq.utils.SyncDatasources.prototype.poll_args=function(){var a=this;if(this.check_args()){this.success_callback.apply();return!1}this.num_checks_so_far++;if(this.num_checks_so_far>=this.num_checks_until_quit){console.log("Maximum number of polling events reached.  Datasets not loaded.  Aborting.");if(this.fail_callback===undefined)return!1;this.fail_callback.apply();return!1}setTimeout(function(){a.poll_args()},a.timeout)},vq.events={},vq.events.Event=function(a,b,c){this.id=a||"",this.source=b||null,this.obj=c||{}},vq.events.Event.prototype.dispatch=function(){vq.events.Dispatcher.dispatch(this)},vq.events.Dispatcher=function(){var a={};return{addListener:function(b){var c,d;if(!(b===undefined||arguments.length<2)){if(arguments.length==2&&typeof arguments[1]=="function")d=arguments[1],c=null;else if(arguments.length==3&&typeof arguments[1]=="string")c=arguments[1],d=arguments[2];else return;a[b]===undefined&&(a[b]={}),a[b][c]===undefined&&(a[b][c]=[]),a[b][c].push(d)}},removeListener:function(b){var c,d;if(!(b===undefined||arguments.length<2)){if(arguments.length==2&&typeof arguments[1]=="function")d=arguments[1],c=null;else if(arguments.length==3&&typeof arguments[1]=="string")c=arguments[1],d=arguments[2];else return;if(a[b]===undefined||a[b][c]===undefined)return;a[b][c].forEach(function(e,f){e===d&&a[b][c].splice(f,1)})}},dispatch:function(b){var c=b.source||null,d=b.id||null,e=null,f=null;if(d!=null&&a[d]!==undefined){if(a[d][c]!==undefined){e=a[d][c].length;while(e--)f=a[d][c][e],f.call(b,b.obj)}if(a[d][null]!==undefined){e=a[d][null].length;while(e--)f=a[d][null][e],f.call(b,b.obj)}}}}}(),vq.Hovercard=function(a){this.id="hovercard_"+vq.utils.VisUtils.guid(),this.hovercard=vq.utils.VisUtils.createDiv(this.id),this.hovercard.style.display="hidden",this.hovercard.style.zIndex=1e5,this.hovercard.style.position="absolute",this.lock_display=!1,a&&(this.timeout=a.timeout||800,this.target_mark=a.target||null,this.data_config=a.data_config||null,this.tool_config=a.tool_config||null,this.self_hover=a.self_hover||!0,this.include_footer=a.include_footer!=null?a.include_footer:this.self_hover||!1,this.include_header=a.include_header!=null?a.include_header:this.self_hover||!0,this.include_frame=a.include_frame!=null?a.include_frame:!1,this.transform=a.transform||new pv.Transform);var b=this;vq.events.Dispatcher.addListener("zoom_select","tooltip",function(){b.togglePin()})},vq.Hovercard.prototype.show=function(a,b){var c=this;if(!a)throw"vq.Hovercard.show: target div not found.";this.target=a,this.hovercard.appendChild(this.renderCard(b));if(this.tool_config){var d=document.createElement("div");d.setAttribute("style","height:1px;background:#000;border:1px solid #333"),this.hovercard.appendChild(d),this.hovercard.appendChild(this.renderTools(b))}this.include_footer&&this.hovercard.appendChild(this.renderFooter()),this.hovercard.style.display="none",this.hovercard.style.backgroundColor="white",this.hovercard.style.borderWidth="2px",this.hovercard.style.borderColor="#222",this.hovercard.style.borderStyle="solid",this.hovercard.style.font="9px sans-serif",this.hovercard.style.borderRadius="10px",this.placeInDocument(),this.getContainer().className="temp",this.start=function(){c.startOutTimer()},this.cancel=function(){c.target_mark.removeEventListener("mouseout",c.start,!1),c.cancelOutTimer()},this.close=function(){c.destroy()},this.target_mark.addEventListener("mouseout",c.start,!1),this.getContainer().addEventListener("mouseover",c.cancel,!1),this.getContainer().addEventListener("mouseout",c.start,!1)},vq.Hovercard.prototype.startOutTimer=function(){var a=this;this.outtimer_id||(this.outtimer_id=window.setTimeout(function(){a.trigger()},a.timeout))},vq.Hovercard.prototype.cancelOutTimer=function(){this.outtimer_id&&(window.clearTimeout(this.outtimer_id),this.outtimer_id=null)},vq.Hovercard.prototype.trigger=function(){this.outtimer_id&&(window.clearTimeout(this.outtimer_id),this.outtimer_id=null,this.destroy());return!1},vq.Hovercard.prototype.togglePin=function(){this.lock_display=!this.lock_display||!1;var a=this;this.getContainer().className==""?(this.getContainer().addEventListener("mouseout",a.start,!1),this.getContainer().className="temp"):(this.target_mark.removeEventListener("mouseout",a.start,!1),this.getContainer().removeEventListener("mouseout",a.start,!1),this.cancelOutTimer(),this.getContainer().className=""),this.pin_div.innerHTML=this.lock_display?vq.Hovercard.icon.pin_in:vq.Hovercard.icon.pin_out},vq.Hovercard.prototype.placeInDocument=function(){var a=this.hovercard,b=this.target,c=vq.utils.VisUtils.cumulativeOffset(this.target);c.height=b.offsetHeight,c.width=b.offsetWidth,a.style.display="block",a.style.visibility="hidden",a.style.top="0px",a.style.left="0px",document.body.appendChild(a),a.style.top=c.top+c.height+20*this.transform.invert().k+"px",a.style.left=c.left+c.width+20*this.transform.invert().k+"px",a.style.visibility="visible";if(this.include_frame){var d=document.createElement("div");d.setAttribute("style","height:1px;background:#000;border:1px solid #333"),this.hovercard.insertBefore(d,this.hovercard.childNodes.item(0)),this.frame=this.hovercard.insertBefore(this.renderFrame(),this.hovercard.childNodes.item(0)),this.attachMoveListener()}},vq.Hovercard.prototype.hide=function(){if(!this.self_hover||!this.over_self)this.hovercard.style.display="none",this.hovercard.style.visibility="hidden"},vq.Hovercard.prototype.destroy=function(){this.hide(),this.target_mark.removeEventListener("mouseout",this.start,!1),this.getContainer().removeEventListener("mouseout",this.start,!1),this.cancelOutTimer(),this.getContainer().parentNode==document.body&&document.body.removeChild(this.getContainer())},vq.Hovercard.prototype.isHidden=function(){return this.hovercard.style.display=="none"||this.hovercard.style.visibility=="hidden"},vq.Hovercard.prototype.renderCard=function(a){return this.renderData(a)},vq.Hovercard.prototype.attachMoveListener=function(){function f(d){var e=d?d:window.event,f=e.clientX?e.clientX:e.pageX,g=e.clientY?e.clientY:e.pageY;a.hovercard.style.left=c.left+(f-b.left)+"px",a.hovercard.style.top=c.top+(g-b.top)+"px"}function e(){window.removeEventListener("mousemove",f,!1),window.removeEventListener("selectstart",vq.utils.VisUtils.disabler,!1),a.getContainer().className=="temp"&&a.getContainer().addEventListener("mouseout",a.start,!1),b={}}function d(d){var e=d?d:window.event;a.getContainer().className=="temp"&&a.getContainer().removeEventListener("mouseout",a.start,!1),window.addEventListener("mousemove",f,!1),c=vq.utils.VisUtils.cumulativeOffset(a.hovercard),b.top=e.clientY?e.clientY:e.pageY,b.left=e.clientX?e.clientX:e.pageX,window.addEventListener("selectstart",vq.utils.VisUtils.disabler,!1)}var a=this,b={},c={};this.move_div.addEventListener("mousedown",d,!1),this.move_div.addEventListener("mouseup",e,!1),window.addEventListener("mouseup",e,!1)},vq.Hovercard.prototype.renderFrame=function(a){function l(){vq.events.Dispatcher.dispatch(new vq.events.Event("select","tooltip",{hovercard:b}));return!1}function j(){vq.events.Dispatcher.dispatch(new vq.events.Event("zoom","tooltip",{hovercard:b}));return!1}function h(){b.togglePin();return!1}var b=this,c=vq.utils.VisUtils.createDiv();c.setAttribute("style","width:100%;cursor:arrow;background:#55eeff");var d=document.createElement("table"),e=document.createElement("tbody");d.appendChild(e);var f=e.insertRow(-1),g=f.insertCell(-1);this.move_div=vq.utils.VisUtils.createDiv("hovercard_move"),this.move_div.setAttribute("style","width:30px;height:15px;background:black;cursor:move;"),this.move_div.setAttribute("title","Drag to move"),vq.utils.VisUtils.disableSelect(this.move_div),g.appendChild(this.move_div),g=f.insertCell(-1),this.pin_div=vq.utils.VisUtils.createDiv(),g.appendChild(this.pin_div),this.pin_div.addEventListener("click",h,!1),this.pin_div.setAttribute("style","width:15px;text-align:center;cursor:pointer;background:#FFF"),vq.utils.VisUtils.disableSelect(this.pin_div),this.pin_div.innerHTML=vq.Hovercard.icon.pin_out,g=f.insertCell(-1);var i=vq.utils.VisUtils.createDiv("hovercard_zoom");g.appendChild(i),i.addEventListener("click",j,!1),g=f.insertCell(-1);var k=vq.utils.VisUtils.createDiv("hovercard_select");g.appendChild(k),k.addEventListener("click",l,!1),c.appendChild(d);return c},vq.Hovercard.prototype.renderTools=function(a){var b=vq.utils.VisUtils.get,c=document.createElement("table");c.setAttribute("style","font-size:10px");var d=document.createElement("tbody");c.appendChild(d);if(this.tool_config)for(var e in this.tool_config)try{if(!this.tool_config.hasOwnProperty(e))continue;var f=d.insertRow(-1),g=f.insertCell(-1),h=document.createElement("a");typeof this.tool_config[e]=="function"?h.setAttribute("href",this.tool_config[e](a)):h.setAttribute("href",b(a,this.tool_config[e])),h.setAttribute("target","_blank"),h.innerHTML=e,g.appendChild(h)}catch(i){console.warn("Data not found for tools in tooltip. "+i)}return c},vq.Hovercard.icon={},vq.Hovercard.icon.pin_in='<span style="font-size:15px;color:#000;" title="Click to unpin card from the window">O</span>',vq.Hovercard.icon.pin_out='<span style="font-size:15px;color:#000" title="Click to pin card to the window">T</span>',vq.Hovercard.prototype.renderData=function(a){var b="",c=vq.utils.VisUtils.get,d=document.createElement("table");if(typeof a=="object"){if(this.include_header){var e=d.createTHead(),f=e.insertRow(-1),g=f.insertCell(-1);g.innerHTML="Property",g=f.insertCell(-1),g.innerHTML="Value"}var h=document.createElement("tbody");d.appendChild(h);if(this.data_config)for(var i in this.data_config)try{if(!this.data_config.hasOwnProperty(i))continue;var j=h.insertRow(-1),k=j.insertCell(-1);k.innerHTML="<b>"+i+"</b>:",k.style.textAlign="right",k=j.insertCell(-1),typeof this.data_config[i]=="function"?k.innerHTML="<span>"+this.data_config[i](a)+"</span>":k.innerHTML="<span>"+c(a,this.data_config[i])+"</span>"}catch(l){console.warn("Data not found for tool tip: "+l)}else pv.keys(a).forEach(function(b){try{var d=h.insertRow(-1),e=d.insertCell(-1);e.innerHTML="<b>"+b+"</b>:",e=d.insertCell(-1),e.innerHTML="<span>"+c(a,b)+"</span>"}catch(f){console.warn("Data not found for tool tip: "+f)}})}else if(typeof a=="string")return a;return d},vq.Hovercard.prototype.getContainer=function(){return this.hovercard},vq.Hovercard.prototype.renderFooter=function(){function d(){a.destroy();return!1}var a=this,b=document.createElement("div");b.setAttribute("style","text-align:right;font-size:13px;margin-right:5px;color:rgb(240,10,10);cursor:pointer;");var c=document.createElement("span");c.addEventListener("click",d,!1),c.innerHTML="CLOSE [X]",b.appendChild(c);return b},pv.Behavior.hovercard=function(a){function j(){var a=document.body.childNodes,b=a.length,c=[];for(var d=0;d<b;d++)a.item(d).id&&a.item(d).id.slice(0,"hovercard_".length)=="hovercard_"&&a.item(d).className!=""&&c.push(a.item(d));return c}var b,c,d,e,f="vq_hover",g,h,i;return function(k){var l=a.param_data?k:this instanceof pv.Mark?this.data()||this.title():k,m,n,o=a.retry||!1,p=this;o?(d=a.target,m=a.event.x,n=a.event.y):(d=pv.event.target,m=this.parent.mouse().x,n=this.parent.mouse().y),a.self_hover=!0,a.include_frame=!0,a.include_footer=!0,a.target=d;var q=j();g=null,h=function(){window.clearTimeout(g)},i=function(){pv.Behavior.hovercard(a).call(p,l)};if(q.length>0&&!o)a.retry=!0,a.event={x:this.parent.mouse().x,y:this.parent.mouse().y},a.param_data=!0,k=l,d.addEventListener("mouseout",h,!1),g=window.setTimeout(i,a.timeout||100);else{if(q.length>0&&o){a.retry=!1,d.removeEventListener("mouseout",h,!1);return}o&&(h(),d.removeEventListener("mouseout",h,!1)),a.retry=!1;var r=pv.Transform.identity,s=this.parent;do r=r.translate(s.left(),s.top()).times(s.transform());while(s=s.parent);var t=this.root.canvas();document.getElementById(t.id+"_rel")?e=document.getElementById(t.id+"_rel"):(e=vq.utils.VisUtils.createDiv(t.id+"_rel"),t.insertBefore(e,t.firstChild),e.style.position="relative",e.style.top="0px",e.style.zIndex=-1),document.getElementById(f)?(c=document.getElementById(f),c.parentNode.id!=e.id&&e.appendChild(c)):(c=vq.utils.VisUtils.createDiv(f),e.appendChild(c),c.style.position="absolute",c.style.zIndex=-1);if(this.properties.width)c.style.width=a.on_mark?Math.ceil(this.width()*r.k)+1:1,c.style.height=a.on_mark?Math.ceil(this.height()*r.k)+1:1;else if(this.properties.radius){var u=this.radius();r.x-=u,r.y-=u,c.style.height=c.style.width=Math.ceil(2*u*r.k)}c.style.left=a.on_mark?Math.floor(this.left()*r.k+r.x)+"px":Math.floor(m*r.k+r.x)+"px",c.style.top=a.on_mark?Math.floor(this.top()*r.k+r.y)+"px":Math.floor(n*r.k+r.y)+"px",a.transform=r,b=new vq.Hovercard(a),b.show(c,l)}}},pv.Behavior.flextip=function(a){function f(){vq.events.Dispatcher.dispatch(new vq.events.Event("close_all_tooltips","flextip",{}))}var b,c,d;a.timeout=a.timeout||800;var e="vq_flex";return function(g){function m(){b.destroy(),vq.events.Dispatcher.removeListener("close_all_tooltips",m);return!1}var h=a.param_data?g:this instanceof pv.Mark?this.data()||this.title():g;f();var i=pv.Transform.identity,j=this.parent;do i=i.translate(j.left(),j.top()).times(j.transform());while(j=j.parent);var k=this.root.canvas();document.getElementById(k.id+"_rel")?d=document.getElementById(k.id+"_rel"):(d=vq.utils.VisUtils.createDiv(k.id+"_rel"),k.insertBefore(d,k.firstChild),d.style.position="relative",d.style.top="0px",d.style.zIndex=-1),document.getElementById(e)?(c=document.getElementById(e),c.parentNode.id!=d.id&&d.appendChild(c)):(c=vq.utils.VisUtils.createDiv(e),d.appendChild(c),c.style.position="absolute",c.style.zIndex=-1),a.include_frame=!1,a.include_footer=!1,a.target=pv.event.target,b=new vq.Hovercard(a);if(this.properties.width)c.style.width=a.on_mark?Math.ceil(this.width()*i.k)+1:1,c.style.height=a.on_mark?Math.ceil(this.height()*i.k)+1:1;else if(this.properties.radius){var l=this.radius();i.x-=l,i.y-=l,c.style.height=c.style.width=Math.ceil(2*l*i.k)}c.style.left=a.on_mark?Math.floor(this.left()*i.k+i.x)+"px":this.parent.mouse().x+i.x+"px",c.style.top=a.on_mark?Math.floor(this.top()*i.k+i.y)+"px":this.parent.mouse().y+i.y+"px",vq.events.Dispatcher.addListener("close_all_tooltips",m),b.show(c,h)}}